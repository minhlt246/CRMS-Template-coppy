<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Meta Tags -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Tạo Sale Mới | CRMS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Favicon -->
    <link rel="shortcut icon" href="assets/img/favicon.png">

    <!-- Apple Icon -->
    <link rel="apple-touch-icon" href="assets/img/apple-icon.png">

    <!-- Theme Config Js -->
    <script src="assets/js/theme-script.js"></script>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">

    <!-- Tabler Icon CSS -->
    <link rel="stylesheet" href="assets/plugins/tabler-icons/tabler-icons.min.css">

    <!-- Simplebar CSS -->
    <link rel="stylesheet" href="assets/plugins/simplebar/simplebar.min.css">

    <!-- Main CSS -->
    <link rel="stylesheet" href="assets/css/style.css" id="app-style">
</head>

<body>
    <!-- Begin Wrapper -->
    <div class="main-wrapper">
        <!-- Topbar -->
        <header class="navbar-header">
            <div class="page-container topbar-menu">
                <div class="d-flex align-items-center gap-2">
                    <a href="index.html" class="logo">
                        <span class="logo-light">
                            <span class="logo-lg"><img src="assets/img/logo.svg" alt="logo"></span>
                            <span class="logo-sm"><img src="assets/img/logo-small.svg" alt="small logo"></span>
                        </span>
                        <span class="logo-dark">
                            <span class="logo-lg"><img src="assets/img/logo-white.svg" alt="dark logo"></span>
                        </span>
                    </a>
                    <a id="mobile_btn" class="mobile-btn" href="#sidebar"><i class="ti ti-menu-deep fs-24"></i></a>
                    <button class="sidenav-toggle-btn btn border-0 p-0" id="toggle_btn2"><i
                            class="ti ti-arrow-bar-to-right"></i></button>
                </div>
                <div class="d-flex align-items-center">
                    <div class="dropdown profile-dropdown d-flex align-items-center justify-content-center">
                        <a href="javascript:void(0);"
                            class="topbar-link dropdown-toggle drop-arrow-none position-relative"
                            data-bs-toggle="dropdown">
                            <img src="assets/img/users/user-40.jpg" width="38" class="rounded-1 d-flex"
                                alt="user-image">
                            <span class="online text-success"><i
                                    class="ti ti-circle-filled d-flex bg-white rounded-circle border border-1 border-white"></i></span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end dropdown-menu-md p-2">
                            <div class="d-flex align-items-center bg-light rounded-3 p-2 mb-2">
                                <img src="assets/img/users/user-40.jpg" class="rounded-circle" width="42" height="42"
                                    alt="Img">
                                <div class="ms-2">
                                    <p class="fw-medium text-dark mb-0">Admin</p>
                                </div>
                            </div>
                            <a href="login.html" class="dropdown-item text-danger">
                                <i class="ti ti-logout me-1 fs-17 align-middle"></i>
                                <span class="align-middle">Sign Out</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-logo">
                <div>
                    <a href="index.html" class="logo logo-normal"><img src="assets/img/logo.svg" alt="Logo"></a>
                    <a href="index.html" class="logo-small"><img src="assets/img/logo-small.svg" alt="Logo"></a>
                    <a href="index.html" class="dark-logo"><img src="assets/img/logo-white.svg" alt="Logo"></a>
                </div>
                <button class="sidenav-toggle-btn btn border-0 p-0 active" id="toggle_btn"><i
                        class="ti ti-arrow-bar-to-left"></i></button>
                <button class="sidebar-close"><i class="ti ti-x align-middle"></i></button>
            </div>
            <div class="sidebar-inner" data-simplebar>
                <div id="sidebar-menu" class="sidebar-menu">
                    <ul>
                        <li class="menu-title"><span>Main Menu</span></li>
                        <li>
                            <ul>
                                <li><a href="index.html"><i class="ti ti-dashboard"></i><span>Dashboard</span></a></li>
                                <li><a href="sales.html"><i class="ti ti-shopping-cart"></i><span>Quản Lý
                                            Sale</span></a></li>
                                <li><a href="order-processing.html"><i class="ti ti-settings"></i><span>Xử Lý Đơn
                                            Hàng</span></a></li>
                                <li><a href="customers.html"><i class="ti ti-users"></i><span>Quản Lý Khách
                                            Hàng</span></a></li>
                                <li><a href="change-password.html"><i class="ti ti-lock"></i><span>Đổi Mật
                                            Khẩu</span></a></li>
                                <li><a href="activities.html"><i
                                            class="ti ti-bounce-right"></i><span>Activities</span></a></li>
                                <li><a href="blogs.html"><i class="ti ti-brand-blogger"></i><span>Blogs</span></a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Page Content -->
        <div class="page-wrapper">
            <div class="content">
                <div class="d-flex align-items-center justify-content-between gap-2 mb-4 flex-wrap">
                    <div>
                        <h4 class="mb-1">Tạo Sale Mới</h4>
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb mb-0 p-0">
                                <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                                <li class="breadcrumb-item"><a href="sales.html">Quản Lý Sale</a></li>
                                <li class="breadcrumb-item active">Tạo Sale Mới</li>
                            </ol>
                        </nav>
                    </div>
                    <div>
                        <a href="sales.html" class="btn btn-outline-secondary"><i class="ti ti-arrow-left me-1"></i>Quay
                            Lại</a>
                    </div>
                </div>

                <div class="row">
                    <div class="col-lg-8">
                        <!-- Customer Information -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">Thông Tin Người Mua Hàng</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Tên Khách Hàng</label>
                                    <input type="text" class="form-control" placeholder="Nhập tên khách hàng">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Số Điện Thoại</label>
                                    <input type="text" class="form-control" placeholder="Nhập số điện thoại">
                                </div>
                                <div class="mb-0">
                                    <label class="form-label">Địa Chỉ</label>
                                    <textarea class="form-control" rows="2" placeholder="Nhập địa chỉ"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Sale Information -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">Thông Tin Sale</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Người Tạo</label>
                                    <input type="text" class="form-control" value="Admin" readonly>
                                </div>
                                <div class="mb-0">
                                    <label class="form-label">Ghi Chú</label>
                                    <textarea class="form-control" rows="3"
                                        placeholder="Nhập ghi chú (nếu có)"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Product Selection -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">Chọn Sản Phẩm</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-7 mb-3">
                                        <label class="form-label">Chọn Sản Phẩm</label>
                                        <select class="form-select">
                                            <option>-- Chọn sản phẩm</option>
                                            <option>Sản phẩm A</option>
                                            <option>Sản phẩm B</option>
                                            <option>Sản phẩm C</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label">Số Lượng</label>
                                        <input type="number" class="form-control" value="1" min="1">
                                    </div>
                                    <div class="col-md-2 mb-3">
                                        <label class="form-label">&nbsp;</label>
                                        <button class="btn btn-primary w-100" type="button" id="addProductBtn"><i
                                                class="ti ti-plus"></i>
                                            Add</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Products List -->
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Danh Sách Sản Phẩm</h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead class="table-light">
                                            <tr>
                                                <th>STT</th>
                                                <th>Tên Sản Phẩm</th>
                                                <th>Giá Tiền</th>
                                                <th>Số Lượng</th>
                                                <th>Tổng</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody id="productTableBody">
                                            <!-- Products will be added here dynamically -->
                                            <tr>
                                                <td colspan="6" class="text-center text-muted">Chưa có sản phẩm nào</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="mt-3 text-end">
                                    <h5>Tổng Cộng: <span class="text-primary" id="totalAmount">0</span> VNĐ</h5>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Thông Tin Thanh Toán</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Phương Thức Thanh Toán</label>
                                    <select class="form-select">
                                        <option>Tiền Mặt</option>
                                        <option>Chuyển Khoản</option>
                                        <option>Thẻ Tín Dụng</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Trạng Thái</label>
                                    <select class="form-select">
                                        <option>Đang Xử Lý</option>
                                        <option>Hoàn Thành</option>
                                        <option>Đã Hủy</option>
                                    </select>
                                </div>
                                <div class="d-grid gap-2">
                                    <button class="btn btn-primary"><i class="ti ti-device-floppy me-1"></i>Lưu
                                        Sale</button>
                                    <button class="btn btn-secondary"><i class="ti ti-x me-1"></i>Hủy</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <footer class="footer d-block d-md-flex justify-content-between text-md-start text-center">
                <p class="mb-md-0 mb-1">Copyright &copy;
                    <script>document.write(new Date().getFullYear())</script> <a href="javascript:void(0);"
                        class="link-primary text-decoration-underline">CRMS</a>
                </p>
            </footer>
        </div>
    </div>

    <script src="assets/js/jquery-3.7.1.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="assets/plugins/simplebar/simplebar.min.js"></script>
    <script src="assets/js/script.js"></script>

    <script>
        // Mảng lưu sản phẩm
        let products = [];
        let sttCounter = 1;

        // Danh sách sản phẩm mẫu
        const productData = {
            'Sản phẩm A': { price: 100000 },
            'Sản phẩm B': { price: 200000 },
            'Sản phẩm C': { price: 150000 }
        };

        // Hàm thêm sản phẩm
        document.getElementById('addProductBtn').addEventListener('click', function () {
            const productSelect = document.querySelector('select');
            const quantityInput = document.querySelector('input[type="number"]');

            const productName = productSelect.value;
            const quantity = parseInt(quantityInput.value);

            if (productName === '-- Chọn sản phẩm' || !productName) {
                alert('Vui lòng chọn sản phẩm!');
                return;
            }

            if (quantity <= 0) {
                alert('Số lượng phải lớn hơn 0!');
                return;
            }

            // Kiểm tra sản phẩm đã tồn tại chưa
            const existingProduct = products.find(p => p.name === productName);
            if (existingProduct) {
                existingProduct.quantity += quantity;
            } else {
                const price = productData[productName].price;
                products.push({
                    name: productName,
                    price: price,
                    quantity: quantity
                });
            }

            updateProductTable();

            // Reset form
            quantityInput.value = 1;
        });

        // Hàm cập nhật bảng sản phẩm
        function updateProductTable () {
            const tbody = document.getElementById('productTableBody');
            let total = 0;

            if (products.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="text-center text-muted">Chưa có sản phẩm nào</td></tr>';
                document.getElementById('totalAmount').textContent = '0';
                return;
            }

            let html = '';
            products.forEach((product, index) => {
                const productTotal = product.price * product.quantity;
                total += productTotal;

                html += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${product.name}</td>
                        <td>${product.price.toLocaleString('vi-VN')} VNĐ</td>
                        <td>${product.quantity}</td>
                        <td>${productTotal.toLocaleString('vi-VN')} VNĐ</td>
                        <td>
                            <button class="btn btn-sm btn-danger" onclick="removeProduct(${index})">
                                <i class="ti ti-trash"></i> Xóa
                            </button>
                        </td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
            document.getElementById('totalAmount').textContent = total.toLocaleString('vi-VN');
        }

        // Hàm xóa sản phẩm
        function removeProduct (index) {
            if (confirm('Bạn có chắc muốn xóa sản phẩm này?')) {
                products.splice(index, 1);
                updateProductTable();
            }
        }
    </script>
</body>

</html>